\documentclass[a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage{amsmath}

\author{Paul Fermé \and Léo Exibard}

\begin{document}

\paragraph{Question 2}

We get the following matrix:

\begin{equation*}
L = \left(
\begin{array}{cccccccccccccccc}
16 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 \\
8 & 10 & 8 & 6 & 8 & 14 & 8 & 10 & 10 & 8 & 6 & 8 & 6 & 8 & 10 & 8 \\
8 & 4 & 8 & 8 & 6 & 10 & 6 & 6 & 8 & 8 & 4 & 8 & 10 & 10 & 6 & 10 \\
8 & 6 & 8 & 6 & 6 & 8 & 6 & 8 & 10 & 8 & 10 & 8 & 8 & 10 & 8 & 2 \\
8 & 10 & 8 & 10 & 8 & 6 & 8 & 6 & 14 & 8 & 6 & 8 & 10 & 8 & 10 & 8 \\
8 & 8 & 4 & 8 & 8 & 8 & 12 & 8 & 8 & 12 & 8 & 8 & 8 & 12 & 8 & 8 \\
8 & 10 & 4 & 10 & 10 & 8 & 6 & 8 & 6 & 4 & 6 & 8 & 8 & 10 & 8 & 6 \\
8 & 8 & 8 & 8 & 10 & 10 & 10 & 2 & 8 & 8 & 8 & 8 & 6 & 6 & 6 & 6 \\
8 & 4 & 6 & 6 & 10 & 6 & 8 & 8 & 8 & 8 & 6 & 10 & 6 & 6 & 12 & 8 \\
8 & 10 & 6 & 8 & 2 & 8 & 8 & 6 & 6 & 8 & 8 & 10 & 8 & 6 & 10 & 8 \\
8 & 8 & 10 & 10 & 8 & 8 & 10 & 10 & 8 & 8 & 6 & 14 & 8 & 8 & 6 & 6 \\
8 & 6 & 10 & 12 & 8 & 10 & 10 & 8 & 6 & 8 & 8 & 6 & 10 & 8 & 12 & 6 \\
8 & 6 & 6 & 8 & 6 & 8 & 12 & 10 & 10 & 4 & 8 & 6 & 8 & 6 & 6 & 8 \\
8 & 8 & 10 & 10 & 6 & 6 & 8 & 8 & 8 & 8 & 6 & 6 & 2 & 10 & 8 & 8 \\
8 & 6 & 6 & 12 & 8 & 10 & 6 & 8 & 10 & 8 & 12 & 10 & 6 & 8 & 8 & 10 \\
8 & 8 & 10 & 6 & 8 & 8 & 10 & 6 & 8 & 4 & 10 & 10 & 8 & 12 & 10 & 10
\end{array}
\right)
\end{equation*}

\paragraph{Question 3}

The farthest probabilities from $\frac{1}{2}$ are:

\begin{equation*}
\begin{array}{|c|c|}
\hline
(a,b) & p_{a,b} \\
\hline
\hline
(0000,0000) & 1 \\
\hline
(0001,0101) & 0.875 \\
\hline
(0011,1111) & 0.125 \\
\hline
(0100,1000) & 0.875 \\
\hline
(0111,0111) & 0.125 \\
\hline
(1001,0100) & 0.125 \\
\hline
(1010,1011) & 0.875 \\
\hline
(1101,1100) & 0.125 \\
\hline
\end{array}
\end{equation*}

The $(0,0)$ couple is not useful, since $0=0$ is a trivial equation which does not give any information.

\paragraph{Question 4}

Experimentally, we have:

\begin{itemize}

\item With the $K_0, K_1$ of Question 1, we have:

\begin{equation*}
\begin{array}{|c|c|}
\hline
(a,b) & Pr(A.m = P(B).x_1) \\
\hline
\hline
(0001,0101) & 0.125 \\
\hline
(0011,1111) & 0.875 \\
\hline
(0100,1000) & 0.125 \\
\hline
(0111,0111) & 0.125 \\
\hline
(1001,0100) & 0.125 \\
\hline
(1010,1011) & 0.125 \\
\hline
(1101,1100) & 0.875 \\
\hline
\end{array}
\end{equation*}

\item With the $K_1, K_2$ of Question 2, we have:

\begin{equation*}
\begin{array}{|c|c|}
\hline
(a,b) & Pr(A.m = P(B).x_1) \\
\hline
\hline
(0001,0101) & 0.875 \\
\hline
(0011,1111) & 0.125 \\
\hline
(0100,1000) & 0.875 \\
\hline
(0111,0111) & 0.125 \\
\hline
(1001,0100) & 0.125 \\
\hline
(1010,1011) & 0.875 \\
\hline
(1101,1100) & 0.125 \\
\hline
\end{array}
\end{equation*}

\end{itemize}

We want to prove that $A.m = P(B).x_1 \text{ w.p. } \dfrac{1}{2} \pm \dfrac{6}{16}$:

We know that $x_1 = K_1 + P(S(m + K_0))$.

\begin{itemize}

\item Case 1: $A . K_0 = B . P^{-1}(K_1)$. We have:

\begin{align*}
P(B).x_1 &= B.(P^{-1}(x_1)) \\
	&= B.(P^{-1}(K_1 + P(S(m + K_0)))) \\
	&= B.P^{-1}(K_1) + B.S(m + K_0) \text{ since $P$ is linear} \\
	&= A.K_0 + B.S(m + K_0) \\
	&= A.K_0 + A.(m + K_0) \text{ w.p. $p_{a,b}$} \\
	&= A.m \text{ w.p. $p_{a,b}$}
\end{align*}

\item Case 2: $A . K_0 = 1 - (B . P^{-1}(K_1))$. We have:

\begin{align*}
P(B).x_1 &= B.(P^{-1}(x_1)) \\
	&= B.(P^{-1}(K_1 + P(S(m + K_0)))) \\
	&= B.P^{-1}(K_1) + B.S(m + K_0) \text{ since $P$ is linear} \\
	&= 1 - A.K_0 + B.S(m + K_0) \\
	&= 1 - A.K_0 + A.(m + K_0) \text{ w.p. $p_{a,b}$} \\
	&= 1 - A.m \text{ w.p. $p_{a,b}$}
\end{align*}

So $P(B).x_1 = A.m$ w.p. $1 - p_{a,b}$

Since $p_{a,b}, 1 - p_{a,b} = \dfrac{1}{2} \pm \dfrac{6}{16}$, we finally have:

\begin{equation*}
A.m = P(B).x_1 \text{ w.p. } \dfrac{1}{2} \pm \dfrac{6}{16}
\end{equation*}

\end{itemize}

\paragraph{Question 5}

By just focusing on the active boxes, we can determine locally some bits of $K_2$, hence reducing the search space.

\paragraph{Question 6}

We get the following table:

\begin{equation*}
  \begin{array}{|c|c|c|}
    \hline
    (a,b) & P(B) & \text{Equation} \\
    \hline
    (0001,0101) & 0100\ 0000\ 0000\ 0000\ 0000\ 0000\ 0000\ 0010 & m_3 = {x_1}^{(1)} \oplus {x_1}^{(30)} \\
    \hline
    (0011,1111) & 1100\ 0000\ 0000\ 0000\ 0000\ 0000\ 0000\ 0011 & m_2 \oplus m_3 = {x_1}^{(0)} \oplus {x_1}^{(1)} \oplus {x_1}^{(30)} \oplus {x_1}^{(31)} \\
    \hline
    (0100,1000) & 0000\ 0000\ 0000\ 0000\ 0000\ 0000\ 0000\ 0010 & m_1 = {x_1}^{(30)} \\
    \hline
    (0111,0111) & 1100\ 0000\ 0000\ 0000\ 0000\ 0000\ 0000\ 0001 & m_1 \oplus m_2 \oplus m_3 = {x_1}^{(0)} \oplus {x_1}^{(1)} \oplus {x_1}^{(31)} \\
    \hline
    (1001,0100) & 0000\ 0000\ 0000\ 0000\ 0000\ 0000\ 0000\ 0001 & m_0 \oplus m_3 = {x_1}^{(31)} \\
    \hline
    (1010,1011) & 1100\ 0000\ 0000\ 0000\ 0000\ 0000\ 0000\ 0010 & m_0 \oplus m_2 = {x_1}^{(0)} \oplus {x_1}^{(1)} \oplus {x_1}^{(30)} \\
    \hline
    (1101,1100) & 0000\ 0000\ 0000\ 0000\ 0000\ 0000\ 0000\ 0011 & m_0 \oplus m_1 \oplus m_3 = {x_1}^{(30)} \oplus {x_1}^{(31)} \\
    \hline
    \hline
    (a,b) & \text{Active boxes} & K_2 \text{ bits that can be set} \\
    \hline
    (0001,0101) & \{0, 7\} & \{2, 3, 4, 5, 30, 31, 0, 1\} \\
    \hline
    (0011,1111) & \{0, 7\} & \{2, 3, 4, 5, 30, 31, 0, 1\} \\
    \hline
    (0100,1000) & \{7\} & \{30, 31, 0, 1\} \\
    \hline
    (0111,0111) & \{0, 7\} & \{2, 3, 4, 5, 30, 31, 0, 1\} \\
    \hline
    (1001,0100) & \{7\} & \{30, 31, 0, 1\} \\
    \hline
    (1010,1011) & \{0, 7\} & \{2, 3, 4, 5, 30, 31, 0, 1\} \\
    \hline
    (1101,1100) & \{7\} & \{30, 31, 0, 1\}  \\
    \hline
  \end{array}
\end{equation*}

<<<<<<< Updated upstream
\paragraph{Question 9}

From $K_2$, we deduce 21 bits of $K$. We simply bruteforce the 10 remaining unknown in $\mathcal{O}(2^{10})$ operations. We get:

$
\begin{array}{rcl}
  K   & = & 00011101111110001111011000110000 \\
  K_0 & = & 10001101101101100011010011001100 \\
  K_1 & = & 00100011101000100001011100000111 \\
  K_2 & = & 10011100000110110001100110100100
\end{array}
$


 \end{document}
=======
\paragraph{Question 7}
With one active box, working on the first position with the couple (4,8), we find the bits 2,3,4,5 of k2 : 0111.

With two active boxes, working on the first position with the couple (10,11), we find the bits 2,...,9 of k2 : 01110000.

\paragraph{Question 8}
With one active box with the couple (4,8) or with two active boxes with the couple
(10,11), we find k2 = 10011100000110110001100110100100.
(We have other values with the other couples, but the last step of the algorithm (question
9) shows that this only value of k2 works).

\end{document}
>>>>>>> Stashed changes
